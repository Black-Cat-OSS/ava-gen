# приложение для геенрации аватаров (как на github, gitlab)

# задачи

- инициализировать backend (рабочая директория проекта: backend)
- написать тесты к модулям (исходя из требований)
- реализовать необходимые модули (опираясь на требования)

# используемый стек

- nestjs
- typescript
- dotenv
- openapi
- swagger
- zod
- sqlite
- prisma/typeorm (для поддержки sqlite)
- pino (логирование)

# требования

- поддержка openapi swagger (переход по <HOST>/swagger)
- сохранение записей в бд
- сохранение изображений в файлах
- сервис должен быть настраиваемым через yaml (settings.yaml)
- настроенное логирование на всех уровнях (для дальнейшего мониторинга)
- готов к контейнеризации (Docker)
- ведение логов
- обработка ошибок, вывод пользователю сообщений через HTTP коды
- модульность
- соблюдение принципов LSP, DRY, SOLID
- не использовать alpha канал в изображении
- проверять пути и различные подключения к базе данных, если что-то не удаётся выводить ошибку

# функционал

- генерация изображения чреез endpoint
- настройка генерации изображения через endpoint
- вывод изображения через endpoint
- сохранение изображений в виде объектов

## endpoints

### генерация

- `/api/generate`
- `/api/generate?primaryColor=`
- `/api/generate?foreignColor=`
- `/api/generate?colorScheme=`
- `/api/generate?seed=`

### получение

- `/api/:id`
- `/api/:id?filter=`
- `/api/:id?size=`

### параметры

#### id

уникальный идентификатор изображения (uuidv4)

#### filter

фильтр который будет применяться изображению:

- grayscale
- sepia (orange by default)
- negative

параметры отразить в документации openapi

#### size

параметр отвечает за масштаб. Будет использоваться следующее правило: 2 в степени n, n <= 9, n > 4. Если на вход подаётся число не входящее в заданный диапазон выдавать ошибку.

#### primaryColor

основной цвет

#### foreignColor

вторичный цвет

> параметры `primaryColor` и `foreignColor` не обязательно связаны между собой, но эти параметры не могут существовать друг от друга атомарно, одновременно их использование опционально (см. `colorScheme`)

#### colorScheme

заранее заготовленная цветовая схема. Подразумевается, что будет массив набора primary и foreign цветов.

пример:

```json
[
  {
    "name": "green",
    "primaryColor": "green",
    "foreignColor": "lightGreen"
  }
]
```

#### seed

опциональный параметр, учавствует в генерации изображения. Тип данных строка с максимальной длиной 32. При переполнении выводить ошибку

### важно

> файл изображения будет представлять из себя следующее:
>
> - \<uuidv4\>.obj
> - в файл будет записываться объект который хранит в себе изображения во всех диапазонах n (см. size)
> - метаданные: время создания, версия (всегда будет 0.0.1)

Важно чтобы сервис сериализовал и десериализовал файл (при записи или обращении к нему). Сервис должен сохранять объекты в путь который указан в настройках (save_path)

# конфигурации

приложение должно уметь работать с yaml файлом, читать его.

## параметры конфигурации

- app.save_path - путь для сохранения объектов
- app.server.host - хост на котром будет запущено приложение
- app.server.host - порт на котром будет запущено приложение
- app.database.driver - драйвер базы данных (на текущую версию только sqlite)
- app.database.sqlite_params - параметры необходимые для работы с sqlite

# объект

объект будет представлять из себя тип следующей структуры:

meta_data_name: string
meta_data_created_at: dateTime
image_4n: byte[]
image_5n: byte[]
image_6n: byte[]
image_7n: byte[]
image_8n: byte[]
image_9n: byte[]

нужно реализовать подобную структуру
