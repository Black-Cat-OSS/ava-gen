# –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Docker

**–î–∞—Ç–∞:** 2025-10-02  
**–í–µ—Ä—Å–∏—è:** 2.0

## üìã –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–ë—ã–ª–æ:**

```
avatar-gen/
‚îú‚îÄ‚îÄ docker-compose.yml              # –í –∫–æ—Ä–Ω–µ
‚îú‚îÄ‚îÄ docker-compose.sqlite.yml       # –í –∫–æ—Ä–Ω–µ
‚îú‚îÄ‚îÄ docker-compose.postgresql.yml   # –í –∫–æ—Ä–Ω–µ
‚îú‚îÄ‚îÄ backend/docker/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                  # –û—Å—Ç–∞–µ—Ç—Å—è –∑–¥–µ—Å—å
‚îÇ   ‚îî‚îÄ‚îÄ README.md                   # –û—Å—Ç–∞–µ—Ç—Å—è –∑–¥–µ—Å—å
‚îî‚îÄ‚îÄ frontend/docker/
    ‚îî‚îÄ‚îÄ Dockerfile                  # –û—Å—Ç–∞–µ—Ç—Å—è –∑–¥–µ—Å—å
```

**–°—Ç–∞–ª–æ:**

```
avatar-gen/
‚îú‚îÄ‚îÄ docker/                         # –ù–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml          # ‚Üê –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã —Å—é–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.sqlite.yml   # ‚Üê –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã —Å—é–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.postgresql.yml # ‚Üê –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã —Å—é–¥–∞
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ backend/docker/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                  # ‚úì –û—Å—Ç–∞–ª—Å—è –Ω–∞ –º–µ—Å—Ç–µ
‚îÇ   ‚îî‚îÄ‚îÄ README.md                   # ‚úì –û—Å—Ç–∞–ª—Å—è –Ω–∞ –º–µ—Å—Ç–µ
‚îî‚îÄ‚îÄ frontend/docker/
    ‚îî‚îÄ‚îÄ Dockerfile                  # ‚úì –û—Å—Ç–∞–ª—Å—è –Ω–∞ –º–µ—Å—Ç–µ
```

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `docker/` –¥–ª—è compose —Ñ–∞–π–ª–æ–≤

- ‚úÖ `docker/` - —Å–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è docker-compose —Ñ–∞–π–ª–æ–≤
- ‚úÖ `docker/README.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

### 2. –ü–µ—Ä–µ–º–µ—â–µ–Ω—ã –¢–û–õ–¨–ö–û Docker Compose —Ñ–∞–π–ª—ã

- ‚úÖ `docker-compose.yml` ‚Üí `docker/docker-compose.yml`
- ‚úÖ `docker-compose.sqlite.yml` ‚Üí `docker/docker-compose.sqlite.yml`
- ‚úÖ `docker-compose.postgresql.yml` ‚Üí `docker/docker-compose.postgresql.yml`

### 3. Dockerfile –û–°–¢–ê–õ–ò–°–¨ –Ω–∞ —Å–≤–æ–∏—Ö –º–µ—Å—Ç–∞—Ö

- ‚úÖ `backend/docker/Dockerfile` - –ù–ï –ø–µ—Ä–µ–º–µ—â–µ–Ω
- ‚úÖ `backend/docker/README.md` - –ù–ï –ø–µ—Ä–µ–º–µ—â–µ–Ω
- ‚úÖ `frontend/docker/Dockerfile` - –ù–ï –ø–µ—Ä–µ–º–µ—â–µ–Ω

### 4. –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—É—Ç–∏ –≤ Docker Compose —Ñ–∞–π–ª–∞—Ö

–ü—É—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `docker/`:

- `context: ./backend` ‚Üí `context: ../backend`
- `context: ./frontend` ‚Üí `context: ../frontend`
- `dockerfile: docker/Dockerfile` - –û–°–¢–ê–õ–°–Ø –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ context)

### 5. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã

–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –≤ `scripts/` –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –ø—É—Ç–µ–π:

- ‚úÖ `scripts/build.sh` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `docker/docker-compose.yml`
- ‚úÖ `scripts/build-fast.sh` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `docker/docker-compose.yml`
- ‚úÖ `scripts/start.sh` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `docker/docker-compose.yml`
- ‚úÖ `scripts/dev.sh` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `docker/docker-compose.yml`
- ‚úÖ `scripts/stop.sh` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `docker/docker-compose.yml`

### 6. –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- ‚úÖ `docker/README.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ Docker —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
- ‚úÖ `docker/DOCKER_BUILD_FIXES.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º —Å–±–æ—Ä–∫–∏
- ‚úÖ `scripts/README.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤
- ‚úÖ –≠—Ç–æ—Ç —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏

## üßπ –ß—Ç–æ –±—ã–ª–æ —É–¥–∞–ª–µ–Ω–æ

–°—Ç–∞—Ä—ã–µ docker-compose —Ñ–∞–π–ª—ã –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞:

```bash
‚úì docker-compose.yml - —É–¥–∞–ª–µ–Ω
‚úì docker-compose.sqlite.yml - —É–¥–∞–ª–µ–Ω
‚úì docker-compose.postgresql.yml - —É–¥–∞–ª–µ–Ω
```

**Dockerfile –ù–ï —É–¥–∞–ª—è–ª–∏—Å—å** - –æ–Ω–∏ –æ—Å—Ç–∞–ª–∏—Å—å –Ω–∞ —Å–≤–æ–∏—Ö –º–µ—Å—Ç–∞—Ö:

- ‚úì `backend/docker/Dockerfile` - –Ω–∞ –º–µ—Å—Ç–µ
- ‚úì `frontend/docker/Dockerfile` - –Ω–∞ –º–µ—Å—Ç–µ

## üóëÔ∏è –û—á–∏—Å—Ç–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
# –£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è
rm MIGRATION_DOCKER_STRUCTURE.md
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# SQLite
docker-compose -f docker/docker-compose.yml -f docker/docker-compose.sqlite.yml config --services

# PostgreSQL
docker-compose -f docker/docker-compose.yml -f docker/docker-compose.postgresql.yml config --services
```

–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:

```
avatar-backend
avatar-frontend
```

### –®–∞–≥ 2: –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
./scripts/build.sh sqlite
```

–ò–ª–∏:

```bash
# –ù–∞–ø—Ä—è–º—É—é
docker-compose -f docker/docker-compose.yml -f docker/docker-compose.sqlite.yml build
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã
./scripts/start.sh sqlite

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
docker-compose -f docker/docker-compose.yml -f docker/docker-compose.sqlite.yml up
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

- Frontend: http://localhost
- Backend API: http://localhost:3000
- Swagger: http://localhost:3000/swagger
- Health check: http://localhost:3000/api/health

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

1. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è compose —Ñ–∞–π–ª–æ–≤** - –≤—Å–µ docker-compose —Ñ–∞–π–ª—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
2. **–ß–∏—Å—Ç–æ—Ç–∞ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞** - –º–µ–Ω—å—à–µ —Ñ–∞–π–ª–æ–≤ –≤ –∫–æ—Ä–Ω–µ (3 —Ñ–∞–π–ª–∞ ‚Üí 0)
3. **–õ–æ–≥–∏—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è** - compose —Ñ–∞–π–ª—ã –≤ `docker/`, Dockerfile –≤ –º–æ–¥—É–ª—è—Ö
4. **–õ—É—á—à–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** - –ø—Ä–æ—â–µ –Ω–∞–π—Ç–∏ compose —Ñ–∞–π–ª—ã
5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏** - Dockerfile –æ—Å—Ç–∞—é—Ç—Å—è —Ä—è–¥–æ–º —Å –∫–æ–¥–æ–º –º–æ–¥—É–ª–µ–π

## üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### –°—Ç–∞—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Å—Ç–∞—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞–ø—Ä—è–º—É—é:

```bash
# –°—Ç–∞—Ä–æ–µ
docker-compose up

# –ù–æ–≤–æ–µ
docker-compose -f docker/docker-compose.yml -f docker/docker-compose.sqlite.yml up
```

### –°–∫—Ä–∏–ø—Ç—ã

–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º:

```bash
./scripts/start.sh
./scripts/build.sh
./scripts/dev.sh
```

## üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã:

- ‚úÖ `docker/README.md` - –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
- ‚úÖ `scripts/README.md` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥
- ‚úÖ `docker/backend/README.md` - –ø–µ—Ä–µ–º–µ—â–µ–Ω –∏–∑ `backend/docker/README.md`

–¢—Ä–µ–±—É—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–µ—Å–ª–∏ —É–ø–æ–º–∏–Ω–∞—é—Ç docker-compose):

- [ ] `README.md` (–∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞)
- [ ] `docs/DOCKER_COMPOSE_README.md`
- [ ] –î—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "Cannot find docker-compose.yml"

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—â–µ–Ω–∞ —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø—É—Ç–µ–º

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ compose —Ñ–∞–π–ª–∞–º –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã:

```bash
docker-compose -f docker/docker-compose.yml -f docker/docker-compose.sqlite.yml up
```

### –û—à–∏–±–∫–∞: "context path does not exist"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ –≤ docker-compose.yml

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ `docker/`

### –°—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

**–†–µ—à–µ–Ω–∏–µ:** –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
docker-compose -f docker-compose.yml down  # —Å—Ç–∞—Ä—ã–π –ø—É—Ç—å
docker-compose -f docker/docker-compose.yml down  # –Ω–æ–≤—ã–π –ø—É—Ç—å
```

## ‚ú® –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤
2. **–°–¥–µ–ª–∞–π—Ç–µ –∫–æ–º–º–∏—Ç** –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
3. **–û–±–Ω–æ–≤–∏—Ç–µ CI/CD** –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ (–ø—É—Ç–∏ –∫ compose —Ñ–∞–π–ª–∞–º)
4. **–û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ
5. **–£–≤–µ–¥–æ–º–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É** –æ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

## üìû –ü–æ–º–æ—â—å

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç–∏ –≤ docker-compose —Ñ–∞–π–ª–∞—Ö
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Docker —Ä–∞–±–æ—Ç–∞–µ—Ç: `docker info`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏: `docker-compose -f docker/docker-compose.yml logs`

---

**–°—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–∏:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞  
**–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤:** ‚è≥ –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
